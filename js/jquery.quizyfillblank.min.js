if(!Array.indexOf){Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++){if(this[b]==a){return b}}return-1}}(function(a){a.fn.quizyFillBlank=function(b){function p(a,b){var c=parseInt(b.offset.left);var d=parseInt(b.offset.top)}function q(b,d){a(this).droppable("disable");d.draggable.addClass("quizy-fitb-dropelement-disabled");d.draggable.draggable("disable");d.draggable.position({of:a(this),my:"left top",at:"left top"});d.draggable.draggable("option","revert",false);var f=a(this).attr("id");var g=f.substring(c.phId.length,f.length);f=d.draggable.attr("id");var m=f.substring(c.answerId.length,f.length);if(e[g]==m){a("#"+c.checkId+m).removeClass("quizy-fitb-res-no").addClass("quizy-fitb-res-yes");a("#"+c.checkId+m).html("&#10003");k++}if(i==0)l=setInterval(r,1e3);i++;if(i==h){clearInterval(l);a("."+c.checkId).fadeIn();a("."+c.numberId).fadeIn();if(c.onFinishCall!=""){c.onFinishCall({correct_answers:k,all_answers:h,time:j})}}}function s(a,b,c,d){if(a.addEventListener){a.addEventListener(b,c,d)}else if(a.attachEvent){a.attachEvent("on"+b,c)}}function t(b){var c=b.changedTouches,d=c[0],e="";switch(b.type){case"touchstart":e="mousedown";break;case"touchmove":e="mousemove";break;case"touchend":e="mouseup";break;default:return}var f=document.createEvent("MouseEvent");f.initMouseEvent(e,true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,false,false,false,false,0,null);d.target.dispatchEvent(f);if(a(b.target).hasClass("draggable-element")||a(b.target).parent().hasClass("draggable-element")){b.preventDefault()}}function u(){s(document,"touchstart",t,true);s(document,"touchmove",t,true);s(document,"touchend",t,true);s(document,"touchcancel",t,true)}var c=a.extend({},a.fn.quizyFillBlank.defaults,b);var d=c.textItems;var e=c.anItemsCorrect;var f=c.anItems;var g=f.length;var h=e.length;var i=0;var j=0;var k=0;var l;var m=a("#"+c.elementAnId);var n=a("#"+c.elementTextId);var o="";for(v=0;v<Math.round(c.blockSize/10);v++){o+="_"}var r=function(){j++};if(c.allowTouchDrag)u();for(var v=0;v<h;v++){n.append("<span>"+d[v]+'</span> <span id="'+c.phId+v+'" class="droppable-element quizy-fitb-droptarget">'+o+"</span> ");if(v==h-1){var w=v+1;n.append("<span>"+d[w]+"</span>")}}var x=m;for(var v=0;v<g;v++){x.append('<div id="'+c.answerId+v+'" class="quizy-fitb-answer draggable-element '+'quizy-fitb-dropelement" style="width:'+c.blockSize+'px">'+f[v]+"</div>");a("#"+c.answerId+v).append('<div id="'+c.checkId+v+'" class="quizy-fitb-res quizy-fitb-res-no '+c.checkId+'">x</div>');a("#"+c.answerId+v).append('<div id="'+c.numberId+v+'" class="quizy-fitb-res quizy-fitb-res-num '+c.checkId+'">'+(parseInt(e.indexOf(v))+1)+"</div>")}a(".draggable-element").draggable({cursor:"move",containment:"document",stop:p,revert:true});a(".droppable-element").droppable({drop:q,hoverClass:"quizy-fitb-droptarget-hover"});for(var v=0;v<g;v++){a("#"+c.checkId+v).position({of:a("#"+c.answerId+v),my:"right center ",at:"right center",offset:"0 5px"});a("#"+c.numberId+v).position({of:a("#"+c.answerId+v),my:"right center",at:"right center",offset:"10px -10px"});a("#"+c.checkId+v).hide();a("#"+c.numberId+v).hide()}};a.fn.quizyFillBlank.defaults={elementAnId:"fillblank-ph",textItems:["Text part1","text part 2","text part 3"],elementTextId:"fillblank-text",anItems:["an1","an2","an3"],anItemsCorrect:[2,0],answerId:"d-answer",phId:"d-nest",checkId:"d-check",numberId:"d-number",blockSize:100,onFinishCall:"",allowTouchDrag:true}})(jQuery)